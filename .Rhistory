filter(participant != "em6_079") %>%#
filter(participant != "em6_60") %>%
filter(participant != "em6_010") %>%
filter(participant != "em6_014") %>%#
filter(participant != "em6_051") %>%
filter(participant != "em6_026")#
# Rename columns as they have old names from previous version
library(stringr)
performance <- performance %>%
mutate(
condsFile = str_replace(condsFile, "noDelay", "maintenance_delay"),
condsFile = str_replace(condsFile, "longDelay", "sampling_delay")
)
# Study time, free response, first trips -----------------
study_time_FR <- performance %>%
filter(!condsFile == "sampling_delayClosing") %>%
filter(!condsFile == "maintenance_delayClosing") %>%
group_by(participant, condsFile) %>%
summarize(mean_MU = mean(meanMU, na.rm = TRUE),
mean_StudyTime = mean(meanListTime, na.rm = TRUE),
.groups = 'drop')
# make sure condition is a factor
study_time_FR$condsFile <- as.factor(study_time_FR$condsFile)
##### Pupil data ########
# Below for data that was processed all at once:
ET_all <- read_csv("cleaned_ET_data.csv", show_col_types = F)
# Remove participants with over 2 incorrect easy problems
ET_all <- ET_all %>%
filter(participant != "em6_017") %>%#
filter(participant != "em6_027") %>%#
filter(participant != "em6_031") %>%#
filter(participant != "em6_058") %>%#
filter(participant != "em6_067") %>%#
filter(participant != "em6_072") %>%#
filter(participant != "em6_079") %>%#
filter(participant != "em6_60") %>%
filter(participant != "em6_010") %>%
filter(participant != "em6_014") %>%#
filter(participant != "em6_051") %>%
filter(participant != "em6_026")#
ET <- ET_all %>%
group_by(participant, condsFile, trial, adjustTrip) %>%
filter(adjustTrip == 1) %>%
filter(condsFile == "maintenance_delay") %>%
filter(stage.x == "shelfBack")
performance_ET <- performance %>%
filter(condsFile == "maintenance_delay") %>%
group_by(participant, condsFile, trial) %>%
summarize(mean_MU = mean(meanMU, na.rm = TRUE),
mean_StudyTime = mean(meanListTime, na.rm = TRUE),
.groups = 'drop')
# get avg value for pupil
pupil_data <- ET %>%
group_by(participant, condsFile, trial) %>%
filter(milliseconds >= 2000 & milliseconds <= 5000) %>%  # Last 3s
summarise(avg_pupil_change = mean(change_from_baseline, na.rm = TRUE),
.groups = "drop")
# Merge the data while keeping all rows from pupil data
pupil_performance <- left_join(performance_ET, pupil_data, by = c("participant", "condsFile", "trial"))
# percent NA for pupil
mean(is.na(pupil_performance$avg_pupil_change)) * 100
# avg per ss
ET_avg <- ET %>%
# Get a trace for each participant
group_by(participant, milliseconds) %>%
summarize(
mean_pupil = mean(change_from_baseline, na.rm = TRUE),
.groups = "drop"
)
# grand avg
ET_avg_grand_avg <- ET %>%
# Get a trace overall
group_by(milliseconds) %>%
summarize(
grand_avg = mean(change_from_baseline, na.rm = TRUE),
.groups = "drop"
)
ggplot() +
geom_line(data = ET_avg,
aes(x = milliseconds, y = mean_pupil, group = participant, color = participant),
size = 1) +
geom_line(data = ET_avg_grand_avg,
aes(x = row_index, y = grand_avg),
color = "black", size = 2) +
labs(title = "Maintenance delay period, preregistered change from baseline",
x = "row index (16.6 ms units)",
y = "Pupil (smoothed, mm)") +
theme_minimal() +
theme(legend.position = "none")
ggplot() +
geom_line(data = ET_avg,
aes(x = milliseconds, y = mean_pupil, group = participant, color = participant),
size = 1) +
geom_line(data = ET_avg_grand_avg,
aes(x = milliseconds, y = grand_avg),
color = "black", size = 2) +
labs(title = "Maintenance delay period, preregistered change from baseline",
x = "row index (16.6 ms units)",
y = "Pupil (smoothed, mm)") +
theme_minimal() +
theme(legend.position = "none")
ET_avg <- ET_avg %>%
filter(participant != "em6_045")
ggplot() +
geom_line(data = ET_avg,
aes(x = milliseconds, y = mean_pupil, group = participant, color = participant),
size = 1) +
geom_line(data = ET_avg_grand_avg,
aes(x = milliseconds, y = grand_avg),
color = "black", size = 2) +
labs(title = "Maintenance delay period, preregistered change from baseline",
x = "row index (16.6 ms units)",
y = "Pupil (smoothed, mm)") +
theme_minimal() +
theme(legend.position = "none")
ggplot() +
geom_line(data = ET_avg,
aes(x = milliseconds, y = mean_pupil, group = participant, color = participant),
size = 1) +
geom_line(data = ET_avg_grand_avg,
aes(x = milliseconds, y = grand_avg),
color = "black", size = 2) +
labs(title = "Maintenance delay period, preregistered change from baseline",
x = "row index (16.6 ms units)",
y = "Pupil (smoothed, mm)") +
theme_minimal() +
theme(legend.position = "none") +
annotate("rect", xmin = 2000, xmax = 5000, ymin = -Inf, ymax = Inf,
alpha = 0.1, fill = "red") +
annotate("text", x = 4000, y = 0.4, label = "Window for analysis",
color = "red", size = 4, fontface = "italic")
## My trace ---------------
all_traces <- read.csv("D:/Canna_d/EM6_stuff/current_data/SG/clean_data/All_ET_with_exploratory_versions.csv")
all_traces <- all_traces %>%
group_by(participant, condsFile, trial, adjustTrip) %>%
filter(adjustTrip == 1) %>%
filter(condsFile == "maintenance_delay") %>%
filter(stage.x.x.x == "shelfBack")
all_traces <- all_traces %>%
filter(participant != "em6_045")
# avg per ss
all_traces_avg <- all_traces %>%
# Get a trace for each participant
group_by(participant, milliseconds) %>%
summarize(
mean_pupil = mean(change_500delay, na.rm = TRUE),
.groups = "drop"
)
# grand avg
all_traces_grand_avg <- all_traces %>%
# Get a trace overall
group_by(milliseconds) %>%
summarize(
grand_avg = mean(change_500delay, na.rm = TRUE),
.groups = "drop"
)
ggplot() +
geom_line(data = all_traces_avg,
aes(x = milliseconds, y = mean_pupil, group = participant, color = participant),
size = 1) +
geom_line(data = all_traces_grand_avg,
aes(x = milliseconds, y = grand_avg),
color = "black", size = 2) +
labs(title = "Maintenance delay period, change from first-500-ms-delay-baseline",
x = "row index (16.6 ms units)",
y = "Pupil (smoothed, mm)") +
theme_minimal() +
theme(legend.position = "none") +
annotate("rect", xmin = 0, xmax = 1000, ymin = -Inf, ymax = Inf,
alpha = 0.1, fill = "red") +
annotate("text", x = 1000, y = 0.4, label = "Preferred window for analysis",
color = "red", size = 4, fontface = "italic")
ggplot() +
geom_line(data = all_traces_avg,
aes(x = milliseconds, y = mean_pupil, group = participant, color = participant),
size = 1) +
geom_line(data = all_traces_grand_avg,
aes(x = milliseconds, y = grand_avg),
color = "black", size = 2) +
labs(title = "Maintenance delay period, change from first-500-ms-delay-baseline",
x = "row index (16.6 ms units)",
y = "Pupil (smoothed, mm)") +
theme_minimal() +
theme(legend.position = "none") +
annotate("rect", xmin = 0, xmax = 2000, ymin = -Inf, ymax = Inf,
alpha = 0.1, fill = "red") +
annotate("text", x = 1000, y = 0.4, label = "Preferred window for analysis",
color = "red", size = 4, fontface = "italic")
100*16.6
# If want to zoom in, use this:
first100_all <- all_traces_avg %>%
group_by(participant) %>%
slice_head(n = 100) %>%
ungroup()
# If want to zoom in, use this:
first100_grand <- all_traces_grand_avg %>%
slice_head(n = 100) %>%
ungroup()
ggplot() +
geom_line(data = all_traces_avg,
aes(x = milliseconds, y = mean_pupil, group = participant, color = participant),
size = 1) +
geom_line(data = all_traces_grand_avg,
aes(x = milliseconds, y = grand_avg),
color = "black", size = 2) +
labs(title = "Maintenance delay period, change from first-500-ms-delay-baseline",
x = "Milliseconds",
y = "Pupil (smoothed, mm)") +
theme_minimal() +
theme(legend.position = "none") +
annotate("rect", xmin = 0, xmax = 2000, ymin = -Inf, ymax = Inf,
alpha = 0.1, fill = "red") +
annotate("text", x = 1000, y = 0.4, label = "Preferred window for analysis",
color = "red", size = 4, fontface = "italic")
ggplot() +
geom_line(data = ET_avg,
aes(x = milliseconds, y = mean_pupil, group = participant, color = participant),
size = 1) +
geom_line(data = ET_avg_grand_avg,
aes(x = milliseconds, y = grand_avg),
color = "black", size = 2) +
labs(title = "Maintenance delay period, preregistered change from baseline",
x = "row index (16.6 ms units)",
y = "Pupil (smoothed, mm)") +
theme_minimal() +
theme(legend.position = "none") +
annotate("rect", xmin = 2000, xmax = 5000, ymin = -Inf, ymax = Inf,
alpha = 0.1, fill = "red") +
annotate("text", x = 4000, y = 0.4, label = "Window for analysis",
color = "red", size = 4, fontface = "italic")
ggplot() +
geom_line(data = ET_avg,
aes(x = milliseconds, y = mean_pupil, group = participant, color = participant),
size = 1) +
geom_line(data = ET_avg_grand_avg,
aes(x = milliseconds, y = grand_avg),
color = "black", size = 2) +
labs(title = "Maintenance delay period, preregistered change from baseline",
x = "Milliseconds",
y = "Pupil (smoothed, mm)") +
theme_minimal() +
theme(legend.position = "none") +
annotate("rect", xmin = 2000, xmax = 5000, ymin = -Inf, ymax = Inf,
alpha = 0.1, fill = "red") +
annotate("text", x = 4000, y = 0.4, label = "Window for analysis",
color = "red", size = 4, fontface = "italic")
# Zoomed in:
ggplot() +
geom_line(data = first100_all,
aes(x = milliseconds, y = mean_pupil, group = participant, color = participant),
size = 1) +
geom_line(data = first100_grand,
aes(x = milliseconds, y = grand_avg),
color = "black", size = 2) +
labs(title = "First 1600ms of maintenance delay period, change from first-500-ms-delay-baseline",
x = "Milliseconds",
y = "Pupil (smoothed, mm)") +
theme_minimal() +
theme(legend.position = "none")
# Zoomed in:
ggplot() +
geom_line(data = first100_all,
aes(x = milliseconds, y = mean_pupil, group = participant, color = participant),
size = 1) +
geom_line(data = first100_grand,
aes(x = milliseconds, y = grand_avg),
color = "black", size = 2) +
labs(title = "First 1600ms of maintenance delay period, change from first-500-ms-delay-baseline",
x = "Milliseconds",
y = "Pupil (smoothed, mm)") +
theme_minimal() +
theme(legend.position = "none") +
scale_y_continuous(limits = c(-0.1, 0.1), breaks = seq(-0.1, 0.1, by = .01))
### Want to look at this again
pupil_MU <- left_join(performance_ET, all_versions, by = c("participant", "condsFile", "trial"))
### Want to look at this again
pupil_MU <- left_join(performance_ET, all_traces, by = c("participant", "condsFile", "trial"))
high_MU <- pupil_MU %>%
filter(mean_MU > 7)
low_MU <- pupil_MU %>%
filter(mean_MU < 7)
View(pupil_MU)
# Specify MU
pupil_MU <- pupil_MU %>%
mutate(
MU_level =
ifelse(mean_MU > 7, "hi", "lo"))
ggplot(pupil_MU, aes(x=milliseconds, y=change_from_baseline, colour=MU_level)) +
geom_line(stat = "summary", size = 2) +
stat_summary(fun = mean,
fun.data = mean_cl_normal,
fun.args = list(conf.int = 0.95),
geom = "ribbon",
fill = "lightblue",
alpha = 0.5) +
labs(title = "Averaged trace of the change-from-baseline pupil size",
subtitle = "Preregistered baseline, hi MU is > 7",
x = "Milliseconds",
y = "Avg Change-from-baseline (mm)") +
#theme_minimal(base_size = 19) +
coord_cartesian(ylim = c(-0.5, 0.5))
ggplot(pupil_MU, aes(x=milliseconds, y=change_from_baseline, colour=MU_level)) +
geom_line(stat = "summary", size = 2) +
stat_summary(fun = mean,
fun.data = mean_cl_normal,
fun.args = list(conf.int = 0.95),
geom = "ribbon",
fill = "lightblue",
alpha = 0.5) +
labs(title = "Averaged trace of the change-from-baseline pupil size",
subtitle = "Preregistered baseline, hi MU is > 7",
x = "Milliseconds",
y = "Avg Change-from-baseline (mm)") +
#theme_minimal(base_size = 19) +
coord_cartesian(ylim = c(-0.5, 0.5)) +
scale_y_continuous(limits = c(-0.25, 0.1), breaks = seq(-0.1, 0.1, by = .01))
ggplot(pupil_MU, aes(x=milliseconds, y=change_from_baseline, colour=MU_level)) +
geom_line(stat = "summary", size = 2) +
stat_summary(fun = mean,
fun.data = mean_cl_normal,
fun.args = list(conf.int = 0.95),
geom = "ribbon",
fill = "lightblue",
alpha = 0.5) +
labs(title = "Averaged trace of the change-from-baseline pupil size",
subtitle = "Preregistered baseline, hi MU is > 7",
x = "Milliseconds",
y = "Avg Change-from-baseline (mm)") +
#theme_minimal(base_size = 19) +
scale_y_continuous(limits = c(-0.25, 0.1), breaks = seq(-0.1, 0.1, by = .01))
ggplot(pupil_MU, aes(x=milliseconds, y=change_from_baseline, colour=MU_level)) +
geom_line(stat = "summary", size = 2) +
stat_summary(fun = mean,
fun.data = mean_cl_normal,
fun.args = list(conf.int = 0.95),
geom = "ribbon",
fill = "lightblue",
alpha = 0.5) +
labs(title = "Averaged trace of the change-from-baseline pupil size",
subtitle = "Preregistered baseline, hi MU is > 7",
x = "Milliseconds",
y = "Avg Change-from-baseline (mm)") +
#theme_minimal(base_size = 19) +
scale_y_continuous(limits = c(-0.25, 0.1), breaks = seq(-0.25, 0.1, by = .01))
ggplot(pupil_MU, aes(x=milliseconds, y=change_from_baseline, colour=MU_level)) +
geom_line(stat = "summary", size = 2) +
stat_summary(fun = mean,
fun.data = mean_cl_normal,
fun.args = list(conf.int = 0.95),
geom = "ribbon",
fill = "lightblue",
alpha = 0.5) +
labs(title = "Averaged trace of the change-from-baseline pupil size",
subtitle = "Preregistered baseline, hi MU is > 7",
x = "Milliseconds",
y = "Avg Change-from-baseline (mm)") +
#theme_minimal(base_size = 19) +
scale_y_continuous(limits = c(-0.15, 0), breaks = seq(-0.25, 0.1, by = .01))
ggplot(pupil_MU, aes(x=milliseconds, y=change_500delay, colour=MU_level)) +
geom_line(stat = "summary", size = 2) +
stat_summary(fun = mean,
fun.data = mean_cl_normal,
fun.args = list(conf.int = 0.95),
geom = "ribbon",
fill = "lightblue",
alpha = 0.5) +
labs(title = "Averaged trace of the change-from-baseline pupil size",
subtitle = "First 500 ms delay baseline, hi MU is > 7",
x = "Milliseconds",
y = "Avg Change-from-baseline (mm)") +
#theme_minimal(base_size = 19) +
scale_y_continuous(limits = c(-0.1, 0.1), breaks = seq(-0.1, 0.1, by = .01))
# If want to zoom in, use this:
first100_mu <- pupil_MU %>%
slice_head(n = 100) %>%
ungroup()
ggplot(first100_mu, aes(x=milliseconds, y=change_500delay, colour=MU_level)) +
geom_line(stat = "summary", size = 2) +
stat_summary(fun = mean,
fun.data = mean_cl_normal,
fun.args = list(conf.int = 0.95),
geom = "ribbon",
fill = "lightblue",
alpha = 0.5) +
labs(title = "Averaged trace of the change-from-baseline pupil size",
subtitle = "First 500 ms delay baseline, hi MU is > 7",
x = "Milliseconds",
y = "Avg Change-from-baseline (mm)") +
#theme_minimal(base_size = 19) +
scale_y_continuous(limits = c(-0.1, 0.1), breaks = seq(-0.1, 0.1, by = .01))
ggplot(first100_mu, aes(x=milliseconds, y=change_500delay, colour=MU_level)) +
geom_line(stat = "summary", size = 2) +
stat_summary(fun = mean,
fun.data = mean_cl_normal,
fun.args = list(conf.int = 0.95),
geom = "ribbon",
fill = "lightblue",
alpha = 0.5) +
labs(title = "Averaged trace of the change-from-baseline pupil size",
subtitle = "First 500 ms delay baseline, hi MU is > 7",
x = "Milliseconds",
y = "Avg Change-from-baseline (mm)") +
#theme_minimal(base_size = 19) +
scale_y_continuous(limits = c(-0.2, 0.2), breaks = seq(-0.2, 0.2, by = .01))
# If want to zoom in, use this:
first100_mu <- pupil_MU %>%
group_by(participant, milliseconds) %>%
slice_head(n = 100) %>%
ungroup()
ggplot(first100_mu, aes(x=milliseconds, y=change_500delay, colour=MU_level)) +
geom_line(stat = "summary", size = 2) +
stat_summary(fun = mean,
fun.data = mean_cl_normal,
fun.args = list(conf.int = 0.95),
geom = "ribbon",
fill = "lightblue",
alpha = 0.5) +
labs(title = "Averaged trace of the change-from-baseline pupil size",
subtitle = "First 500 ms delay baseline, hi MU is > 7",
x = "Milliseconds",
y = "Avg Change-from-baseline (mm)") +
#theme_minimal(base_size = 19) +
scale_y_continuous(limits = c(-0.2, 0.2), breaks = seq(-0.2, 0.2, by = .01))
# If want to zoom in, use this:
first100_mu <- pupil_MU %>%
group_by(participant) %>%
slice_head(n = 100) %>%
ungroup()
ggplot(first100_mu, aes(x=milliseconds, y=change_500delay, colour=MU_level)) +
geom_line(stat = "summary", size = 2) +
stat_summary(fun = mean,
fun.data = mean_cl_normal,
fun.args = list(conf.int = 0.95),
geom = "ribbon",
fill = "lightblue",
alpha = 0.5) +
labs(title = "Averaged trace of the change-from-baseline pupil size",
subtitle = "First 500 ms delay baseline, hi MU is > 7",
x = "Milliseconds",
y = "Avg Change-from-baseline (mm)") +
#theme_minimal(base_size = 19) +
scale_y_continuous(limits = c(-0.2, 0.2), breaks = seq(-0.2, 0.2, by = .01))
ggplot(first100_mu, aes(x=milliseconds, y=change_from_baseline, colour=MU_level)) +
geom_line(stat = "summary", size = 2) +
stat_summary(fun = mean,
fun.data = mean_cl_normal,
fun.args = list(conf.int = 0.95),
geom = "ribbon",
fill = "lightblue",
alpha = 0.5) +
labs(title = "Averaged trace of the change-from-baseline pupil size",
subtitle = "First 500 ms delay baseline, hi MU is > 7",
x = "Milliseconds",
y = "Avg Change-from-baseline (mm)") +
#theme_minimal(base_size = 19) +
scale_y_continuous(limits = c(-0.2, 0.2), breaks = seq(-0.2, 0.2, by = .01))
ggplot(first100_mu, aes(x=milliseconds, y=smoothed_pupil3, colour=MU_level)) +
geom_line(stat = "summary", size = 2) +
stat_summary(fun = mean,
fun.data = mean_cl_normal,
fun.args = list(conf.int = 0.95),
geom = "ribbon",
fill = "lightblue",
alpha = 0.5) +
labs(title = "Averaged trace of the change-from-baseline pupil size",
subtitle = "First 500 ms delay baseline, hi MU is > 7",
x = "Milliseconds",
y = "Avg Change-from-baseline (mm)") +
#theme_minimal(base_size = 19) +
scale_y_continuous(limits = c(-0.2, 0.2), breaks = seq(-0.2, 0.2, by = .01))
ggplot(first100_mu, aes(x=milliseconds, y=change_500listEnd, colour=MU_level)) +
geom_line(stat = "summary", size = 2) +
stat_summary(fun = mean,
fun.data = mean_cl_normal,
fun.args = list(conf.int = 0.95),
geom = "ribbon",
fill = "lightblue",
alpha = 0.5) +
labs(title = "Averaged trace of the change-from-baseline pupil size",
subtitle = "First 500 ms delay baseline, hi MU is > 7",
x = "Milliseconds",
y = "Avg Change-from-baseline (mm)") +
#theme_minimal(base_size = 19) +
scale_y_continuous(limits = c(-0.2, 0.2), breaks = seq(-0.2, 0.2, by = .01))
ggplot(first100_mu, aes(x=milliseconds, y=pupil_zscore, colour=MU_level)) +
geom_line(stat = "summary", size = 2) +
stat_summary(fun = mean,
fun.data = mean_cl_normal,
fun.args = list(conf.int = 0.95),
geom = "ribbon",
fill = "lightblue",
alpha = 0.5) +
labs(title = "Averaged trace of the change-from-baseline pupil size",
subtitle = "First 500 ms delay baseline, hi MU is > 7",
x = "Milliseconds",
y = "Avg Change-from-baseline (mm)") +
#theme_minimal(base_size = 19) +
scale_y_continuous(limits = c(-0.2, 0.2), breaks = seq(-0.2, 0.2, by = .01))
ggplot(first100_mu, aes(x=milliseconds, y=change_from_baseline, colour=MU_level)) +
geom_line(stat = "summary", size = 2) +
stat_summary(fun = mean,
fun.data = mean_cl_normal,
fun.args = list(conf.int = 0.95),
geom = "ribbon",
fill = "lightblue",
alpha = 0.5) +
labs(title = "Averaged trace of the change-from-baseline pupil size",
subtitle = "First 500 ms delay baseline, hi MU is > 7",
x = "Milliseconds",
y = "Avg Change-from-baseline (mm)") +
#theme_minimal(base_size = 19) +
scale_y_continuous(limits = c(-0.2, 0.2), breaks = seq(-0.2, 0.2, by = .01))
